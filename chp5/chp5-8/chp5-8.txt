5-8.Interactive SQLの利用

IBConsoleから[TOOL]-[Interactive SQL]を選択することで、Interactive SQL(図5-8-1)を起動することができます。Interactive SQLにはIBConsoleから起動されるGUI版とコマンドライン版(isql)があります。GUI版でもコマンドライン版でも提供している機能はすべて同じで、用途に分けて使用するといいでしょう。筆者の場合、作成するスキーマ情報が書かれたSQLファイルを実行するときやLinux上で利用するときはコマンドライン版を使用し、それ以外はGUI版を利用しています。

図5-8-1.Interactive SQL
(fig5-8-1.bmp)

GUI版では上部がSQL文の入力領域、下部が結果の出力領域となっています。基本的に、上部にSQL文を入力してから実行ボタンを押して、下部に出力される結果を確認しながら使います。また、Interactive SQLからデータベースに再接続したりすることもできますが、IBConsoleで選択したデータベース以外に接続することはできません。。データベースに接続するときは、[Database]-[Connect As]を選択し、[Database Connect]ダイアログボックス（図5-8-2)にてユーザー名、パスワード、キャラクターセット、ロールを指定します。SJIS_0208やEUCJ_0208などの日本語のキャラクターセットを使用している場合は、再接続を行ってデータベースのデフォルトキャラクターセットを指定して接続を行ってください。

図5-8-2.[Database Connect]ダイアログボックス
(fig5-8-2.bmp)

[Edit]-[Options]で表示される[SQL Options]ダイアログボックス(図5-8-3)でInteractive SQLの設定を行うことができます。また、各オプションの説明は表5-8-1のようになります。

図5-8-3.[SQL Options]ダイアログボックス
(fig5-8-3.bmp)

表5-8-1.オプションの説明
(table.xls内の表5-8-1)

それでは実際にSQLファイル文を入力して実行してみましょう。入力領域に"SELECT * FROM EMPLOYEE"と入力し、実行ボタンを押します。図5-8-4のようにEMPLOYEEテーブルのデータが出力領域に表示されます。

図5-8-4.EMPLOYEEテーブルのデータ
(fig5-8-4.bmp)

トランザクションをコミットしたいときは、[Transaction]-[Commit]を選択してコミット処理を行います。同様に[Transaction]-[Rollback]を選択することで、ロールバック処理を実行することができます。テーブル、トリガー、ストアドプロシージャの作成やデータの追加・更新・削除・閲覧などSQL文で行える処理はすべてInteractive SQLで行うことができます。Firebirdの操作に慣れるためにもInteractive SQLで様々な操作を行ってみるといいでしょう。

